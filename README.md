## 台站值班客户端挂机程序
- 广西广播电视技术中心的台站值班客户端软件，在运行一段时间（20+小时）会出现卡死现象，弹出多个程序错误窗口（内存溢出等），导致无法听到各系统的告警声音，必须手动结束值班客户端进程，再重新打开台站值班客户端软件。
- 因台站值班客户端多在WindowsXP/Win7使用，所以选用了更为轻便的C#进行开发本程序的界面和功能。
- 在24小时无人值班过程中，让电脑自动重启台站值班客户端，“挂机”相当于每天手动重启一次台站值班客户端，进而避免台站值班客户端卡死。
- 加入了启动、关闭、重启台站值班客户端软件的功能，也可以在该挂机软件界面上选择台站值班客户端启动后所显示的（FM、TV等）系统界面。
- 据说是因为插件或补丁的问题？总之以后可能不用这个台站值班客户端了。  

---

- 本挂机程序的目标：在初期配置好挂机程序的配置项后，投入使用挂机，让值班人员完全脱离键盘，只用鼠标操作，就可对台站值班客户端进行：
启动（自动登录）、关闭（结束进程）、定时重启、选择启动后显示的不同系统（FM、TV等），减少因客户端卡死所造成的风险。

---

<img src="https://github.com/jokkkkkkkkkkkkkk/BOT_Client/blob/master/screenshot.PNG" alt="软件截图"/>

---

## 使用  
运行环境：Windows7 x64（推荐）；.NET Framework 4.0（必要） 及以上  
- 1. 进入文件夹《台站客户端挂机程序》
- 2. 如果使用的不是2019.07.10版本的客户端，则要打开【MD5校验器.exe】，浏览文件，找到用于运行挂机的【台站（值班）客户端.exe】，计算出客户端的sha1值
- 3. 文本编辑器打开 BOT_Client.exe.Config：  
  （1）（若非2019.07.10版本，则必要）复制客户端sha1值 ，修改该文件里 sha1 字段的值: key="sha1" value="...."  
  （2）修改 userName / passWord 字段的值（字母和数字），即要输入的用户名和密码，如 bj123t   
  （3）修改 rebootHour、rebootMin、rebootSec 字段的值（数字），即每天自动重启时间的时、分、秒（默认2：30：00）  
  （4）修改 stationExeName 字段的值，为要运行的客户端的文件名：台站客户端 或 台站值班客户端  
  （5）修改完成，保存退出    
- 4. 运行 BOT_Client.exe / 客户端挂机程序

注：目前请不要在挂机程序运行的时候，去修改 BOT_Client.exe.Config 文件，否则会导致挂机程序卡死，之后的版本会修复此问题  

---

## 更新日志
- [2020-08-15](#2020-08-15)
- [2019-09-26](#2019-09-26)
- [2018-02-20](#2018-02-20)
- [2017-07-07](#2017-07-07)
- [挂机软件功能介绍](#挂机软件功能介绍)
### 2020-08-15
- 程序版本：V1.13
- 台站客户端版本：2019.07.10（优先） 或 2019.04.18（要修改配置文件里的 sha1值 和 stationExeName值）
### 更新：
	1.增加客户端文件名的设置项，在 BOT_Client.exe.config 设置
	2.不再进入电视系统界面，暂时改为进入电力系统界面
	3.将界面按钮坐标数据抽出为常量，并重新校准
	4.BOT_Client.exe.config 中，客户端文件的sha1值字符串不再要求全部小写
	5.更改为VS2015项目
### 待修复问题：
	1.挂机程序正在运行，修改配置文件 BOT_Client.exe.Config 的内容并保存后，挂机程序卡死	
---
### 2019-09-26
- 程序版本：V1.12
- 台站客户端版本：至少为2019年，2017只为测试和演示使用
### 更新：
	1.增加用户名和密码的设置项，在 BOT_Client.exe.config 设置
	2.增加自动重启时间（时/分/秒）的设置项，在 BOT_Client.exe.config 设置
	3.取消了程序的安装/卸载。使用时直接复制/删除文件夹
### 待修复问题：
	1.挂机程序正在运行，修改配置文件 BOT_Client.exe.Config 的内容并保存后，挂机程序卡死	
### 2018-02-20
- 程序版本：V1.11
- 台站客户端版本：2017.11.30
- 注：台站客户端从该版本开始，如果运行客户端的电脑不在台站内网，启动台站客户端.exe的时候，点击“进入”之后客户端程序会卡死，应该为研发部/枢纽台增加了不允许非台站内网的电脑运行台站客户端程序，就是说连不上台站内网，不让你运行这个客户端！
### 更新：
	1.开始挂机后，将“关闭客户端”按键失效，防止误点击关闭值班客户端
	2.启动/重启客户端：加入文件判断（sha1），所选文件是否为设定指向的台站值班客户端.exe
	3.选择文件：修改初始路径为F盘根目录
---
### 2017-07-07
- 程序版本：V1.10
- 台站客户端版本：2017.04.28
- 注：此版本作为第一版来投入使用。
---
## 挂机软件功能介绍
- [功能介绍](#%e5%8a%9f%e8%83%bd%e4%bb%8b%e7%bb%8d)
  - [界面按键功能](#%e7%95%8c%e9%9d%a2%e6%8c%89%e9%94%ae%e5%8a%9f%e8%83%bd)
  - [界面选择功能](#%e7%95%8c%e9%9d%a2%e9%80%89%e6%8b%a9%e5%8a%9f%e8%83%bd)
  - [读取和保存配置功能](#%e8%af%bb%e5%8f%96%e5%92%8c%e4%bf%9d%e5%ad%98%e9%85%8d%e7%bd%ae%e5%8a%9f%e8%83%bd)
  - [桌面分辨率判断功能](#%e6%a1%8c%e9%9d%a2%e5%88%86%e8%be%a8%e7%8e%87%e5%88%a4%e6%96%ad%e5%8a%9f%e8%83%bd)
  - [用到的辅助类](#%e7%94%a8%e5%88%b0%e7%9a%84%e8%be%85%e5%8a%a9%e7%b1%bb)
  - [本程序自动登陆台站值班客户端的逻辑/流程](%e6%9c%ac%e7%a8%8b%e5%ba%8f%e8%87%aa%e5%8a%a8%e7%99%bb%e9%99%86%e5%8f%b0%e7%ab%99%e5%80%bc%e7%8f%ad%e5%ae%a2%e6%88%b7%e7%ab%af%e7%9a%84%e9%80%bb%e8%be%91%2f%e6%b5%81%e7%a8%8b)
---
### 界面按键功能：
	1.选择文件：选择版本日期正确的台站（值班）客户端.exe；
		会在“启动”和“挂机”之前比对所选文件的sha1值是否正确，文件不正确则不响应动作
	2.启动、重启值班客户端
	3.关闭：关闭正在运行的值班客户端
	4.挂机：每天定时在规定的时间重启一次值班客户端；
		开始挂机后会显示为“停止挂机”按键；
	5.退出：退出挂机软件，但不关闭值班客户端。
### 界面选择功能：
	1.每天在规定的时间自动重启值班客户端
	2.关闭值班客户端里的“信号源系统”声音
	3.显示值班客户端里的“FM系统”
	4.显示值班客户端里的“TV系统”
### 读取和保存配置功能：
	1.每次启动时会读取配置文件“BOT_Client.exe.config”中的各个配置项目：
		fullFilePath：台站值班客户端.exe的文件路径
		stationExeName：客户端文件名
		autoReatart：每天定时自动重启值班客户端，勾选为true，不勾选为false
		silent：关闭“信号源系统”声音
		sysShow：值班客户端启动之后显示的系统，调频系统为fm，电视系统为tv
		stationVer：台站值班客户端.exe的软件版本日期
		md5/sha1/crc32：台站值班客户端.exe的文件识别码
		version：此挂机软件的版本号
		releaseDate：此挂机软件的发布日期
	2.每次退出之前会保存各个配置项目到配置文件。
### 桌面分辨率判断功能
	直接用屏幕的宽度像素进行判断。在这里将桌面分辨率分为16:9和4:3两种：
	4:3
	1024*768， 1280*960，1152*864，800*600
	16:9
	1920*1080，1600*900，1280*720
	其余分辨率当做4:3处理。
### 用到的辅助类
	HashHelper: 计算文件的SHA1值
	InputHelper：模拟鼠标和键盘的单个动作；将字符串转换为对应的键盘键码
	ProcessHelper：进程相关动作，启动外部程序、结束进程、判断进程数量
### 本程序自动登陆台站值班客户端的逻辑/流程
	1.屏蔽鼠标键盘，防止不必要的操作
	2.最小化挂机软件窗口
	3.最小化桌面上所有程序的窗口
	4.启动台站客户端.exe进程
	5.使电脑的Windows系统静音
	6.（必要延时 >1.2s）
	7.获得屏幕分辨率
	8.根据分辨率最大化值班客户端窗口
	9.键盘动作：自动输入用户名和密码（本台站的该版本都为 bs247t ），TAB和回车等等
	（注：更换台站使用此软件时，必须要更换对应台站的用户名和密码，直接在 BOT_Client.exe.config 中修改对应字串 ）
	10.（必要延时 >1s）
	11.鼠标动作：关闭信号源系统声音，选择显示的系统等等
	12.解锁鼠标键盘
	13.（必要延时，用于静音广西广播电视远程网络监控系统” >5s）
	14.解除系统静音
