## 台站值班客户端挂机程序
- 广西广播电视技术中心的台站值班客户端.exe软件在运行一段时间（20+小时）后会出现卡死现象，并且弹出多个程序错误窗口（内存溢出等），导致无法听到各系统的告警声音，必须手动结束值班客户端进程，再重新打开台站值班客户端软件。
- 因台站值班客户端多在WindowsXP/Win7使用，所以选用了更为轻便的C#进行开发本程序的界面和功能。
- 在24小时无人值班过程中，让电脑自动重启台站值班客户端.exe软件，“挂机”就相当于每天手动重启一次台站值班客户端.exe软件，避免客户端卡死情况的发生。
- 另外加入了启动、关闭、重启台站值班客户端软件的功能，也可以在该挂机软件界面上选择启动台站值班客户端时所显示的系统界面。
- 据说是因为Flash插件的问题？除非提供Flash修复工具和新版本的Flash在内网下载后再说。
---

<img src="https://github.com/jokkkkkkkkkkkkkk/BOT_Client/blob/master/screenshot.PNG" alt="软件截图"/>

---

## 使用  
运行环境：Windows7 x64（推荐）；.NET Framework 4.0 及以上（必要）  
- 1. 直接拷贝《台站客户端挂机程序》文件夹到电脑  
- 2. 打开【MD5校验器.exe】，浏览电脑文件夹，找到用于运行挂机的【台站值班客户端.exe】，计算出文件的sha1值
- 3. 文本编辑器打开 BOT_Client.exe.Config：  
  （1）复制客户端sha1值（用 word/excel/notepad++ 等工具转换为小写） ，修改 BOT_Client.exe.config 文件里对应的value: key="sha1" value="...."  
  （2）修改 userName / passWord 字段的值（字母和数字的组合），即想要输入的用户名和密码  
  （3）修改 rebootHour、rebootMin、rebootSec 字段的值（数字），即自动重启时间的时、分、秒  
  （4）修改完成后保存退出    
- 4. 运行 BOT_Client.exe / 客户端挂机程序

注1：目前请不要在挂机程序运行的时候修改 BOT_Client.exe.Config 文件，否则会导致程序卡死，之后的版本会修复此问题  

---

## 更新日志
- [2020-08-15](#2019-08-15)
- [2019-09-26](#2019-09-26)
- [2018-02-20](#2018-02-20)
- [2017-07-07](#2017-07-07)
### 2020-08-15
- 程序版本：V1.13
- 台站客户端版本：至少为2019.04.18
### 更新：
	1.增加客户端文件名的设置项，在 BOT_Client.exe.config 设置
	2.不再进入电视系统界面，暂时改为进入电力系统界面
	3.将界面按钮坐标数据抽出为常量，并重新校准
	4.更改为VS2015项目
### 待修复问题：
	1.挂机程序正在运行，修改配置文件 BOT_Client.exe.Config 的内容并保存后，挂机程序卡死	
### 2019-09-26
- 程序版本：V1.12
- 台站客户端版本：至少为2019年，2017只为测试和演示使用
### 更新：
	1.增加用户名和密码的设置项，在 BOT_Client.exe.config 设置
	2.增加自动重启时间（时/分/秒）的设置项，在 BOT_Client.exe.config 设置
	3.取消了程序的安装/卸载。使用时直接复制/删除文件夹
### 待修复问题：
	1.挂机程序正在运行，修改配置文件 BOT_Client.exe.Config 的内容并保存后，挂机程序卡死	
### 2018-02-20
- 程序版本：V1.11
- 台站客户端版本：2017.11.30
- 注：台站客户端从该版本开始，如果运行客户端的电脑不在台站内网，启动台站客户端.exe的时候，点击“进入”之后客户端程序会卡死，应该为研发部/枢纽台增加了不允许非台站内网的电脑运行台站客户端程序，就是说连不上台站内网，不让你运行这个客户端！
### 更新：
	1.开始挂机后，将“关闭客户端”按键失效，防止误点击关闭值班客户端
	2.启动/重启客户端：加入文件判断（sha1），所选文件是否为设定指向的台站值班客户端.exe
	3.选择文件：修改初始路径为F盘根目录
---
### 2017-07-07
- 程序版本：V1.10
- 台站客户端版本：2017.04.28
- 注：此版本作为第一版来投入使用。
## 功能介绍
- [功能介绍](#%e5%8a%9f%e8%83%bd%e4%bb%8b%e7%bb%8d)
  - [界面按键功能](#%e7%95%8c%e9%9d%a2%e6%8c%89%e9%94%ae%e5%8a%9f%e8%83%bd)
  - [界面选择功能](#%e7%95%8c%e9%9d%a2%e9%80%89%e6%8b%a9%e5%8a%9f%e8%83%bd)
  - [读取和保存配置功能](#%e8%af%bb%e5%8f%96%e5%92%8c%e4%bf%9d%e5%ad%98%e9%85%8d%e7%bd%ae%e5%8a%9f%e8%83%bd)
  - [桌面分辨率判断功能](#%e6%a1%8c%e9%9d%a2%e5%88%86%e8%be%a8%e7%8e%87%e5%88%a4%e6%96%ad%e5%8a%9f%e8%83%bd)
  - [用到的辅助类](#%e7%94%a8%e5%88%b0%e7%9a%84%e8%be%85%e5%8a%a9%e7%b1%bb)
  - [本程序自动登陆台站值班客户端的逻辑/流程](%e6%9c%ac%e7%a8%8b%e5%ba%8f%e8%87%aa%e5%8a%a8%e7%99%bb%e9%99%86%e5%8f%b0%e7%ab%99%e5%80%bc%e7%8f%ad%e5%ae%a2%e6%88%b7%e7%ab%af%e7%9a%84%e9%80%bb%e8%be%91%2f%e6%b5%81%e7%a8%8b)
---
### 界面按键功能：
	1.选择文件：选择版本日期正确的值班客户端.exe；
		会在“启动”和“挂机”之前比对所选文件的sha1值是否正确，文件不正确则不响应动作
	2.启动、重启值班客户端
	3.关闭：关闭正在运行的值班客户端
	4.挂机：每天定时在02:30重启一次值班客户端；
		开始挂机后会显示为“停止挂机”按键；
	5.退出：退出挂机软件，但不关闭值班客户端。
### 界面选择功能：
	1.每天定时在02:30自动重启值班客户端
	2.关闭值班客户端里的“信号源系统”声音
	3.显示值班客户端里的“FM系统”
	4.显示值班客户端里的“TV系统”
### 读取和保存配置功能：
	1.每次启动时会读取配置文件“BOT_Client.exe.config”中的各个配置项目：
		fullFilePath：台站值班客户端.exe的文件路径
		autoReatart：每天定时自动重启值班客户端，勾选为true，不勾选为false
		silent：关闭“信号源系统”声音
		sysShow：值班客户端启动之后显示的系统，调频系统为fm，电视系统为tv
		stationVer：台站值班客户端.exe的软件版本日期
		md5/sha1/crc32：台站值班客户端.exe的文件识别码
		version：此挂机软件的版本号
		releaseDate：此挂机软件的发布日期
	2.每次退出之前会保存各个配置项目到配置文件。
### 桌面分辨率判断功能
	直接用屏幕的宽度像素进行判断。在这里将桌面分辨率分为16:9和4:3两种：
	4:3
	1024*768， 1280*960，800*600
	16:9
	1920*1080，1600*900，1280*720
	其余分辨率当做4:3处理。
### 用到的辅助类
	HashHelper: 计算文件的SHA1值
	InputHelper：模拟鼠标和键盘的单个动作；将字符串转换为对应的键盘键码
	ProcessHelper：进程相关动作，启动外部程序、结束进程、判断进程数量
### 本程序自动登陆台站值班客户端的逻辑/流程
	1.屏蔽鼠标键盘动作，防止不必要的操作
	2.最小化挂机软件窗口
	3.最小化桌面上所有程序的窗口
	4.启动台站客户端.exe进程
	5.使电脑的Windows系统静音
	6.（必要延时 >1.2s）
	7.获得屏幕分辨率
	8.根据分辨率最大化值班客户端窗口
	9.键盘动作：输入用户名和密码（本台站的该版本都为bs247t），TAB和回车等
	（注：更换台站使用此软件时，必须要更换对应台站的用户名和密码，请根据网上的键盘键值表来修改后重新用VS发布exe程序）
	10.（必要延时 >1s）
	11.鼠标动作：关闭信号源系统声音，选择显示的系统等等
	12.解锁鼠标键盘
	13.（必要延时，用于静音“广西广播电视远程网络监控系统” >5s）
	14.解除系统静音
